
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://malayagr.github.io/bookacle/usage/">
      
      
        <link rel="prev" href="../license/">
      
      
        <link rel="next" href="models/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Usage - bookacle</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/custom.css">
    
      <link rel="stylesheet" href="../stylesheets/links.css">
    
      <link rel="stylesheet" href="../stylesheets/logo.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Usage - bookacle" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://malayagr.github.io/bookacle/assets/images/social/usage/index.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://malayagr.github.io/bookacle/usage/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Usage - bookacle" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://malayagr.github.io/bookacle/assets/images/social/usage/index.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="bookacle" class="md-header__button md-logo" aria-label="bookacle" data-md-component="logo">
      <img id="logo_light_mode" src="../assets/logo-light.svg" alt="logo">
<img id="logo_dark_mode" src="../assets/logo-dark.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            bookacle
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/MalayAgr/bookacle/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
    
  
  Usage

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../reference/" class="md-tabs__link">
          
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="bookacle" class="md-nav__button md-logo" aria-label="bookacle" data-md-component="logo">
      <img id="logo_light_mode" src="../assets/logo-light.svg" alt="logo">
<img id="logo_dark_mode" src="../assets/logo-dark.svg" alt="logo">
    </a>
    bookacle
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MalayAgr/bookacle/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href=".." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Home
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="loaders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Document Loaders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="splitters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Document Splitters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tokenizers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tokenizers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="clustering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clustering Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="building-raptor-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building RAPTOR Tree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="retriever/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Retrievers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command-Line Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    bookacle
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            bookacle
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> bookacle
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> bookacle
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/chat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> chat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> cli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/conf/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> conf
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_4" id="__nav_3_1_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> conf
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/conf/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> config
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/document/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> document
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/loaders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> loaders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/models/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> models
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_7" id="__nav_3_1_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_7">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/embedding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> embedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/message/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> message
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/qa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> qa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/summarization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> summarization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/splitters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> splitters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tokenizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> tokenizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/tree/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> tree
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_10" id="__nav_3_1_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_10">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> tree
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tree/builder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> builder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tree/clustering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> clustering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tree/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tree/retriever/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> retriever
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tree/structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> structures
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-rag-application" class="md-nav__link">
    <span class="md-ellipsis">
      Example RAG Application
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example RAG Application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#full-code" class="md-nav__link">
    <span class="md-ellipsis">
      Full Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step-walkthrough" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Walkthrough
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Chat Interface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chat Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#launch-from-a-script" class="md-nav__link">
    <span class="md-ellipsis">
      Launch from a script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terminal-based-chat" class="md-nav__link">
    <span class="md-ellipsis">
      Terminal-based Chat
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/MalayAgr/bookacle/edit/main/docs/usage/index.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/MalayAgr/bookacle/raw/main/docs/usage/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">¤</a></h1>
<h2 id="example-rag-application">Example RAG Application<a class="headerlink" href="#example-rag-application" title="Permanent link">¤</a></h2>
<p>This guide demonstrates how to create a Retrieval-Augmented Generation (RAG) pipeline using <code>bookacle</code>. You only need 16 lines of code to get started!</p>
<h3 id="full-code">Full Code<a class="headerlink" href="#full-code" title="Permanent link">¤</a></h3>
<p>The complete example shows how to load a document, create a RAPTOR tree for retrieval, and run a query on the document.</p>
<details class="code">
<summary>Code</summary>
<div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">bookacle.loaders</span> <span class="kn">import</span> <span class="n">pymupdf_loader</span>
<span class="kn">from</span> <span class="nn">bookacle.models.embedding</span> <span class="kn">import</span> <span class="n">SentenceTransformerEmbeddingModel</span>
<span class="kn">from</span> <span class="nn">bookacle.models.message</span> <span class="kn">import</span> <span class="n">Message</span>
<span class="kn">from</span> <span class="nn">bookacle.models.qa</span> <span class="kn">import</span> <span class="n">OllamaQAModel</span>
<span class="kn">from</span> <span class="nn">bookacle.models.summarization</span> <span class="kn">import</span> <span class="n">HuggingFaceLLMSummarizationModel</span>
<span class="kn">from</span> <span class="nn">bookacle.splitters</span> <span class="kn">import</span> <span class="n">HuggingFaceTextSplitter</span>
<span class="kn">from</span> <span class="nn">bookacle.tree.builder</span> <span class="kn">import</span> <span class="n">ClusterTreeBuilder</span>
<span class="kn">from</span> <span class="nn">bookacle.tree.config</span> <span class="kn">import</span> <span class="n">ClusterTreeConfig</span><span class="p">,</span> <span class="n">TreeRetrieverConfig</span>
<span class="kn">from</span> <span class="nn">bookacle.tree.retriever</span> <span class="kn">import</span> <span class="n">TreeRetriever</span>

<span class="n">documents</span> <span class="o">=</span> <span class="n">pymupdf_loader</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/the-godfather.pdf&quot;</span><span class="p">)</span>

<span class="n">embedding_model</span> <span class="o">=</span> <span class="n">SentenceTransformerEmbeddingModel</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;sentence-transformers/all-MiniLM-L6-v2&quot;</span>
<span class="p">)</span>

<span class="n">summarization_model</span> <span class="o">=</span> <span class="n">HuggingFaceLLMSummarizationModel</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;Qwen/Qwen2-0.5B-Instruct&quot;</span><span class="p">,</span>
    <span class="n">summarization_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">qa_model</span> <span class="o">=</span> <span class="n">OllamaQAModel</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;qwen2.5:0.5b-instruct&quot;</span><span class="p">)</span>

<span class="n">document_splitter</span> <span class="o">=</span> <span class="n">HuggingFaceTextSplitter</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">=</span><span class="n">embedding_model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">)</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">ClusterTreeConfig</span><span class="p">(</span>
    <span class="n">embedding_model</span><span class="o">=</span><span class="n">embedding_model</span><span class="p">,</span>
    <span class="n">summarization_model</span><span class="o">=</span><span class="n">summarization_model</span><span class="p">,</span>
    <span class="n">document_splitter</span><span class="o">=</span><span class="n">document_splitter</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">tree_builder</span> <span class="o">=</span> <span class="n">ClusterTreeBuilder</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">tree_builder</span><span class="o">.</span><span class="n">build_from_documents</span><span class="p">(</span><span class="n">documents</span><span class="o">=</span><span class="n">documents</span><span class="p">)</span>

<span class="n">retriever_config</span> <span class="o">=</span> <span class="n">TreeRetrieverConfig</span><span class="p">(</span><span class="n">embedding_model</span><span class="o">=</span><span class="n">embedding_model</span><span class="p">)</span>
<span class="n">retriever</span> <span class="o">=</span> <span class="n">TreeRetriever</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">retriever_config</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;Who are the cast members of The Godfather?&quot;</span>

<span class="n">_</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">retriever</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">tree</span><span class="o">=</span><span class="n">tree</span><span class="p">)</span>

<span class="n">system_prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;You are a helpful assistant, designed to help users understand documents and answer questions on the documents.</span>
<span class="s2">Use your knowledge and the context passed to you to answer user queries.</span>
<span class="s2">The context will be text extracted from the document. It will be denoted by CONTEXT: in the prompt.</span>
<span class="s2">The user&#39;s query will be denoted by QUERY: in the prompt.</span>
<span class="s2">Do NOT explicitly state that you are referring to the context.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">history</span> <span class="o">=</span> <span class="p">[</span><span class="n">Message</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">system_prompt</span><span class="p">)]</span>

<span class="n">answer</span> <span class="o">=</span> <span class="n">qa_model</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span>
    <span class="n">question</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="n">history</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Answer:</span><span class="se">\n</span><span class="si">{</span><span class="n">answer</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</details>
<h3 id="step-by-step-walkthrough">Step-by-Step Walkthrough<a class="headerlink" href="#step-by-step-walkthrough" title="Permanent link">¤</a></h3>
<p>We now walk through the code step-by-step with explanations of each part.</p>
<details class="imports">
<summary>Imports</summary>
<div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">bookacle.loaders</span> <span class="kn">import</span> <span class="n">pymupdf_loader</span>
<span class="kn">from</span> <span class="nn">bookacle.models.embedding</span> <span class="kn">import</span> <span class="n">SentenceTransformerEmbeddingModel</span>
<span class="kn">from</span> <span class="nn">bookacle.models.qa</span> <span class="kn">import</span> <span class="n">OllamaQAModel</span>
<span class="kn">from</span> <span class="nn">bookacle.models.summarization</span> <span class="kn">import</span> <span class="n">HuggingFaceLLMSummarizationModel</span>
<span class="kn">from</span> <span class="nn">bookacle.splitters</span> <span class="kn">import</span> <span class="n">HuggingFaceTextSplitter</span>
<span class="kn">from</span> <span class="nn">bookacle.tree.builder</span> <span class="kn">import</span> <span class="n">ClusterTreeBuilder</span>
<span class="kn">from</span> <span class="nn">bookacle.tree.config</span> <span class="kn">import</span> <span class="n">ClusterTreeConfig</span><span class="p">,</span> <span class="n">TreeRetrieverConfig</span>
<span class="kn">from</span> <span class="nn">bookacle.tree.retriever</span> <span class="kn">import</span> <span class="n">TreeRetriever</span>
<span class="kn">from</span> <span class="nn">bookacle.models.message</span> <span class="kn">import</span> <span class="n">Message</span>
</code></pre></div>
<div class="result"></div>
</details>
<p>We start by loading the data file using <a class="autorefs autorefs-internal" href="../reference/loaders/#bookacle.loaders.pymupdf_loader"><code>pymupdf_loader()</code></a>, which uses <a href="https://pymupdf.readthedocs.io/en/latest/">PyMuPDF</a> to load the PDF file as text. The example uses the first 2 pages (when exported in A3) of the Wikipedia entry on <a href="https://en.wikipedia.org/wiki/The_Godfather">The Godfather</a>:</p>
<div class="language-python highlight"><pre><span></span><code><span class="n">documents</span> <span class="o">=</span> <span class="n">pymupdf_loader</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/the-godfather.pdf&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of documents: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First document:</span><span class="se">\n</span><span class="si">{</span><span class="n">documents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="result">
<div class="language-python highlight"><pre><span></span><code><span class="n">Number</span> <span class="n">of</span> <span class="n">documents</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">First</span> <span class="n">document</span><span class="p">:</span>
<span class="p">{</span><span class="s1">&#39;page_content&#39;</span><span class="p">:</span> <span class="s1">&#39;The Godfather</span><span class="se">\n</span><span class="s1">Theatrical release poster</span><span class="se">\n</span><span class="s1">Directed by</span><span class="se">\n</span><span class="s1">Francis Ford Coppola</span><span class="se">\n</span><span class="s1">Screenplay by</span><span class="se">\n</span><span class="s1">Mario Puzo</span><span class="se">\n</span><span class="s1">Francis Ford Coppola</span><span class="se">\n</span><span class="s1">Based on</span><span class="se">\n</span><span class="s1">The Godfather</span><span class="se">\n</span><span class="s1">by Mario Puzo</span><span class="se">\n</span><span class="s1">Produced by</span><span class="se">\n</span><span class="s1">Albert S. Ruddy</span><span class="se">\n</span><span class="s1">Starring</span><span class="se">\n</span><span class="s1">Marlon Brando</span><span class="se">\n</span><span class="s1">Al Pacino</span><span class="se">\n</span><span class="s1">James Caan</span><span class="se">\n</span><span class="s1">Richard Castellano</span><span class="se">\n</span><span class="s1">Robert Duvall</span><span class="se">\n</span><span class="s1">Sterling Hayden</span><span class="se">\n</span><span class="s1">John Marley</span><span class="se">\n</span><span class="s1">Richard Conte</span><span class="se">\n</span><span class="s1">Diane Keaton</span><span class="se">\n</span><span class="s1">Cinematography</span><span class="se">\n</span><span class="s1">Gordon Willis</span><span class="se">\n</span><span class="s1">Edited by</span><span class="se">\n</span><span class="s1">William Reynolds</span><span class="se">\n</span><span class="s1">Peter Zinner</span><span class="se">\n</span><span class="s1">Music by</span><span class="se">\n</span><span class="s1">Nino Rota</span><span class="se">\n</span><span class="s1">Production</span><span class="se">\n</span><span class="s1">companies</span><span class="se">\n</span><span class="s1">Paramount Pictures</span><span class="se">\n</span><span class="s1">Alfran Productions</span><span class="se">\n</span><span class="s1">Distributed by</span><span class="se">\n</span><span class="s1">Paramount Pictures</span><span class="se">\n</span><span class="s1">Release dates</span><span class="se">\n</span><span class="s1">March</span><span class="se">\xa0</span><span class="s1">14,</span><span class="se">\xa0</span><span class="s1">1972 (Loew</span><span class="se">\&#39;</span><span class="s1">s</span><span class="se">\n</span><span class="s1">State Theatre)</span><span class="se">\n</span><span class="s1">March</span><span class="se">\xa0</span><span class="s1">24,</span><span class="se">\xa0</span><span class="s1">1972 (United</span><span class="se">\n</span><span class="s1">States)</span><span class="se">\n</span><span class="s1">Running time</span><span class="se">\n</span><span class="s1">175 minutes</span><span class="se">\n</span><span class="s1">Country</span><span class="se">\n</span><span class="s1">United States</span><span class="se">\n</span><span class="s1">Language</span><span class="se">\n</span><span class="s1">English</span><span class="se">\n</span><span class="s1">Budget</span><span class="se">\n</span><span class="s1">$6–7.2 million</span><span class="se">\n</span><span class="s1">Box oﬃce</span><span class="se">\n</span><span class="s1">$250–291 million</span><span class="se">\n</span><span class="s1">The Godfather</span><span class="se">\n</span><span class="s1">The Godfather is a 1972 American epic gangster film directed by Francis Ford Coppola, who</span><span class="se">\n</span><span class="s1">co-wrote the screenplay with Mario Puzo, based on Puzo</span><span class="se">\&#39;</span><span class="s1">s best-selling 1969 novel. The film stars</span><span class="se">\n</span><span class="s1">an ensemble cast including Marlon Brando, Al Pacino, James Caan, Richard Castellano, Robert</span><span class="se">\n</span><span class="s1">Duvall,  Sterling  Hayden,  John  Marley,  Richard  Conte  and  Diane  Keaton.  It  is  the  first</span><span class="se">\n</span><span class="s1">installment in The Godfather trilogy, chronicling the Corleone family under patriarch Vito</span><span class="se">\n</span><span class="s1">Corleone (Brando) from 1945 to 1955. It focuses on the transformation of his youngest son,</span><span class="se">\n</span><span class="s1">Michael Corleone (Pacino), from reluctant family outsider to ruthless mafia boss.</span><span class="se">\n</span><span class="s1">Paramount Pictures obtained the rights to the novel for $80,000, before it gained popularity.</span><span class="se">\n</span><span class="s1">Studio executives had trouble finding a director; the first few candidates turned down the</span><span class="se">\n</span><span class="s1">position before Coppola signed on to direct the film but disagreement followed over casting</span><span class="se">\n</span><span class="s1">several  characters,  in  particular,  Vito  (Brando)  and  Michael  (Pacino).  Filming  took  place</span><span class="se">\n</span><span class="s1">primarily in locations around New York City and Sicily, and it was completed ahead of schedule.</span><span class="se">\n</span><span class="s1">The score was composed principally by Nino Rota, with additional pieces by Carmine Coppola.</span><span class="se">\n</span><span class="s1">The Godfather premiered at the Loew</span><span class="se">\&#39;</span><span class="s1">s State Theatre on March 14, 1972, and was widely</span><span class="se">\n</span><span class="s1">released in the United States on March 24, 1972. It was the highest-grossing film of 1972, and</span><span class="se">\n</span><span class="s1">was for a time the highest-grossing film ever made, earning between $250 and $291 million at</span><span class="se">\n</span><span class="s1">the box office. The film was acclaimed by critics and audiences, who praised its performances—</span><span class="se">\n</span><span class="s1">particularly those of Brando and Pacino—direction, screenplay, story, cinematography, editing,</span><span class="se">\n</span><span class="s1">score and portrayal of the mafia. The Godfather launched the successful careers of Coppola,</span><span class="se">\n</span><span class="s1">Pacino and other relative newcomers in the cast and crew. At the 45th Academy Awards, the film</span><span class="se">\n</span><span class="s1">won Best Picture, Best Actor (Brando) and Best Adapted Screenplay (for Puzo and Coppola). In</span><span class="se">\n</span><span class="s1">addition, the seven other Oscar nominations included Pacino, Caan and Duvall, all for Best</span><span class="se">\n</span><span class="s1">Supporting Actor, and Coppola for Best Director.</span><span class="se">\n</span><span class="s1">The Godfather is regarded as one of the greatest and most influential films ever made, as well as</span><span class="se">\n</span><span class="s1">a landmark of the gangster genre. It was selected for preservation in the U.S. National Film</span><span class="se">\n</span><span class="s1">Registry  of  the  Library  of  Congress  in  1990,  being  deemed  &quot;culturally,  historically,  or</span><span class="se">\n</span><span class="s1">aesthetically significant&quot; and is ranked the second-greatest film in American cinema (behind</span><span class="se">\n</span><span class="s1">Citizen Kane) by the American Film Institute. It was followed by sequels The Godfather Part II</span><span class="se">\n</span><span class="s1">(1974) and The Godfather Part III (1990). Pauline Kael wrote that &quot;If ever there was a great</span><span class="se">\n</span><span class="s1">example of how the best popular movies come out of a merger of commerce and art, The</span><span class="se">\n</span><span class="s1">Godfather is it.&quot;</span><span class="se">\n</span><span class="s1">In 1945, the New York City Corleone family don, Vito Corleone, listens to requests during his</span><span class="se">\n</span><span class="s1">daughter Connie</span><span class="se">\&#39;</span><span class="s1">s wedding to Carlo Rizzi. Vito</span><span class="se">\&#39;</span><span class="s1">s youngest son Michael, a Marine who has thus</span><span class="se">\n</span><span class="s1">far stayed out of the family business, introduces his girlfriend, Kay Adams, to his family at the</span><span class="se">\n</span><span class="s1">reception. Johnny Fontane, a popular singer and Vito</span><span class="se">\&#39;</span><span class="s1">s godson, seeks Vito</span><span class="se">\&#39;</span><span class="s1">s help in securing a</span><span class="se">\n</span><span class="s1">movie role. Vito sends his consigliere, Tom Hagen, to persuade studio president Jack Woltz to</span><span class="se">\n</span><span class="s1">offer Johnny the part. Woltz refuses Hagen</span><span class="se">\&#39;</span><span class="s1">s request at first, but soon complies after finding the severed head of his prized stud horse in his</span><span class="se">\n</span><span class="s1">bed.</span><span class="se">\n</span><span class="s1">As Christmas approaches, drug baron Virgil &quot;The Turk&quot; Sollozzo asks Vito to invest in his narcotics business and for police protection. Vito</span><span class="se">\n</span><span class="s1">declines, citing that involvement in narcotics would alienate his political connections. Suspicious of Sollozzo</span><span class="se">\&#39;</span><span class="s1">s partnership with the Tattaglia</span><span class="se">\n</span><span class="s1">crime family, Vito sends his enforcer Luca Brasi to the Tattaglias on an espionage mission. Brasi is garroted to death during the initial meeting.</span><span class="se">\n</span><span class="s1">Later, enforcers gun down Vito and coerce Hagen into a meeting. With Vito</span><span class="se">\&#39;</span><span class="s1">s first-born Sonny now in command, Sollozzo pressures Hagen to</span><span class="se">\n</span><span class="s1">persuade Sonny to accept the narcotics deal. Vito survives the shooting and is visited in the hospital by Michael, who finds him unprotected</span><span class="se">\n</span><span class="s1">after NYPD officers on Sollozzo</span><span class="se">\&#39;</span><span class="s1">s payroll clear out Vito</span><span class="se">\&#39;</span><span class="s1">s guards. Michael thwarts the attempt on his father</span><span class="se">\&#39;</span><span class="s1">s life but is beaten by corrupt police</span><span class="se">\n</span><span class="s1">captain Mark McCluskey. After the attempted hit at the hospital, Sonny retaliates with a hit on Bruno Tattaglia. Sollozzo and McCluskey</span><span class="se">\n</span><span class="s1">request to meet with Michael and settle the dispute. Michael feigns interest and agrees to meet, but hatches a plan with Sonny and Corleone</span><span class="se">\n</span><span class="s1">capo Clemenza to kill them and go into hiding. Michael meets Sollozzo and McCluskey at a Bronx restaurant; after retrieving a handgun</span><span class="se">\n</span><span class="s1">planted in the bathroom by Clemenza, he shoots both men dead.</span><span class="se">\n</span><span class="s1">Despite a clampdown by the authorities for the killing of a police captain, the Five Families erupt in open warfare. Michael takes refuge in</span><span class="se">\n</span><span class="s1">Sicily and Fredo, Vito</span><span class="se">\&#39;</span><span class="s1">s second son, is sheltered by Moe Greene in Las Vegas. In Sicily, Michael meets and marries a local woman, Apollonia.</span><span class="se">\n</span><span class="s1">Sonny publicly attacks and threatens Carlo for physically abusing Connie. When he abuses her again, Sonny speeds to their home but is</span><span class="se">\n</span><span class="s1">ambushed and murdered by gangsters at a highway toll booth. Apollonia is killed shortly thereafter by a car bomb intended for Michael.</span><span class="se">\n</span><span class="s1">Devastated by Sonny</span><span class="se">\&#39;</span><span class="s1">s death and tired of war, Vito sets a meeting with the Five Families. He assures them that he will withdraw his opposition</span><span class="se">\n</span><span class="s1">to their narcotics business and forgo avenging Sonny</span><span class="se">\&#39;</span><span class="s1">s murder. His safety guaranteed, Michael returns home to enter the family business and</span><span class="se">\n</span><span class="s1">Plot</span><span class="se">\n</span><span class="s1">The Godfather - Wikipedia</span><span class="se">\n</span><span class="s1">https://en.wikipedia.org/wiki/The_Godfather</span><span class="se">\n</span><span class="s1">1 of 11</span><span class="se">\n</span><span class="s1">19/10/24, 14:37</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;PDF 1.7&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;creator&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla Firefox 131.0.2&#39;</span><span class="p">,</span> <span class="s1">&#39;producer&#39;</span><span class="p">:</span> <span class="s1">&#39;cairo 1.18.0 (https://cairographics.org)&#39;</span><span class="p">,</span> <span class="s1">&#39;creationDate&#39;</span><span class="p">:</span> <span class="s2">&quot;D:20241019143725+05&#39;30&quot;</span><span class="p">,</span> <span class="s1">&#39;modDate&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;trapped&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;encryption&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;page&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}}</span>
</code></pre></div>
</div>
<details class="note" open="open">
<summary>More on Document Loaders</summary>
<p>See <a href="loaders/">Document Loaders</a> for more details on loaders and how you can create your own loaders.</p>
</details>
<p>Then we create the embedding model and the summarization model that will be used to create the RAPTOR tree. We also create the question-answering model that will be used to answer user queries on the PDF document.</p>
<ul>
<li>For the embedding model, we are using <a class="autorefs autorefs-internal" href="../reference/models/embedding/#bookacle.models.embedding.SentenceTransformerEmbeddingModel"><code>SentenceTransformerEmbeddingModel</code></a> to load the <a href="https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2"><code>all-MiniLM-L6-v2</code></a> model from the <a href="https://sbert.net/"><code>sentence-transformers</code></a> library.</li>
<li>For the summarization model, we are using <a class="autorefs autorefs-internal" href="../reference/models/summarization/#bookacle.models.summarization.HuggingFaceLLMSummarizationModel"><code>HuggingFaceLLMSummarizationModel</code></a> to load the <a href="https://huggingface.co/Qwen/Qwen2-0.5B-Instruct"><code>Qwen/Qwen2-0.5B-Instruct</code></a> LLM from <a href="https://huggingface.co/">HuggingFace</a>.</li>
<li>For the question-answering model, we are using <a class="autorefs autorefs-internal" href="../reference/models/qa/#bookacle.models.qa.OllamaQAModel"><code>OllamaQAModel</code></a> to load the <a href="https://ollama.com/library/qwen2.5:0.5b-instruct"><code>qwen2.5:0.5b-instruct</code></a> model from <a href="https://ollama.com/">Ollama</a>.</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span class="n">embedding_model</span> <span class="o">=</span> <span class="n">SentenceTransformerEmbeddingModel</span><span class="p">(</span>
        <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;sentence-transformers/all-MiniLM-L6-v2&quot;</span>
    <span class="p">)</span>

<span class="n">summarization_model</span> <span class="o">=</span> <span class="n">HuggingFaceLLMSummarizationModel</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;Qwen/Qwen2-0.5B-Instruct&quot;</span><span class="p">,</span>
    <span class="n">summarization_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">qa_model</span> <span class="o">=</span> <span class="n">OllamaQAModel</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;qwen2.5:0.5b-instruct&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Embedding Model: </span><span class="si">{</span><span class="n">embedding_model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Summarization Model: </span><span class="si">{</span><span class="n">summarization_model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;QA Model: </span><span class="si">{</span><span class="n">qa_model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="result">
<div class="language-python highlight"><pre><span></span><code><span class="n">Embedding</span> <span class="n">Model</span><span class="p">:</span> <span class="n">SentenceTransformerEmbeddingModel</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;sentence-transformers/all-MiniLM-L6-v2&#39;</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Summarization</span> <span class="n">Model</span><span class="p">:</span> <span class="n">HuggingFaceLLMSummarizationModel</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;Qwen/Qwen2-0.5B-Instruct&#39;</span><span class="p">,</span> <span class="n">summarization_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">system_prompt</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">QA</span> <span class="n">Model</span><span class="p">:</span> <span class="n">OllamaQAModel</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;qwen2.5:0.5b-instruct&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
<details class="note" open="open">
<summary>More on Models</summary>
<p>See <a href="models/">Models</a> for more details on models and how you can create your own models.</p>
</details>
<p>We then create the document splitter that will be used to split documents into chunks. We are using <a class="autorefs autorefs-internal" href="../reference/splitters/#bookacle.splitters.HuggingFaceTextSplitter"><code>HuggingFaceTextSplitter</code></a>, which uses a HuggingFace tokenizer as the length function to decide when a piece of text should be split.</p>
<div class="language-python highlight"><pre><span></span><code><span class="n">document_splitter</span> <span class="o">=</span> <span class="n">HuggingFaceTextSplitter</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">=</span><span class="n">embedding_model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">document_splitter</span><span class="p">)</span>
</code></pre></div>
<div class="result">
<div class="language-python highlight"><pre><span></span><code><span class="n">HuggingFaceTextSplitter</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">=</span><span class="n">BertTokenizerFast</span><span class="p">(</span><span class="n">name_or_path</span><span class="o">=</span><span class="s1">&#39;sentence-transformers/all-MiniLM-L6-v2&#39;</span><span class="p">,</span> <span class="n">vocab_size</span><span class="o">=</span><span class="mi">30522</span><span class="p">,</span> <span class="n">model_max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">is_fast</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">padding_side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">truncation_side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">special_tokens</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unk_token&#39;</span><span class="p">:</span> <span class="s1">&#39;[UNK]&#39;</span><span class="p">,</span> <span class="s1">&#39;sep_token&#39;</span><span class="p">:</span> <span class="s1">&#39;[SEP]&#39;</span><span class="p">,</span> <span class="s1">&#39;pad_token&#39;</span><span class="p">:</span> <span class="s1">&#39;[PAD]&#39;</span><span class="p">,</span> <span class="s1">&#39;cls_token&#39;</span><span class="p">:</span> <span class="s1">&#39;[CLS]&#39;</span><span class="p">,</span> <span class="s1">&#39;mask_token&#39;</span><span class="p">:</span> <span class="s1">&#39;[MASK]&#39;</span><span class="p">},</span> <span class="n">clean_up_tokenization_spaces</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>  <span class="n">added_tokens_decoder</span><span class="o">=</span><span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="n">AddedToken</span><span class="p">(</span><span class="s2">&quot;[PAD]&quot;</span><span class="p">,</span> <span class="n">rstrip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lstrip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">single_word</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">special</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="mi">100</span><span class="p">:</span> <span class="n">AddedToken</span><span class="p">(</span><span class="s2">&quot;[UNK]&quot;</span><span class="p">,</span> <span class="n">rstrip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lstrip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">single_word</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">special</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="mi">101</span><span class="p">:</span> <span class="n">AddedToken</span><span class="p">(</span><span class="s2">&quot;[CLS]&quot;</span><span class="p">,</span> <span class="n">rstrip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lstrip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">single_word</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">special</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="mi">102</span><span class="p">:</span> <span class="n">AddedToken</span><span class="p">(</span><span class="s2">&quot;[SEP]&quot;</span><span class="p">,</span> <span class="n">rstrip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lstrip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">single_word</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">special</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="mi">103</span><span class="p">:</span> <span class="n">AddedToken</span><span class="p">(</span><span class="s2">&quot;[MASK]&quot;</span><span class="p">,</span> <span class="n">rstrip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lstrip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">single_word</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">special</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="p">},</span> <span class="n">separators</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;!&#39;</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">])</span>
</code></pre></div>
</div>
<details class="note" open="open">
<summary>More on Document Splitters</summary>
<p>See <a href="splitters/">Document Splitters</a> for more details on splitters and how you can create your own splitters.</p>
<p>You can also use custom tokenizers by implementing the <a class="autorefs autorefs-internal" href="../reference/tokenizer/#bookacle.tokenizer.TokenizerLike"><code>TokenizerLike</code></a> protocol. See <a href="tokenizers/">Tokenizers</a> for more details.</p>
</details>
<p>Next, we create the RAPTOR tree using <a class="autorefs autorefs-internal" href="../reference/tree/builder/#bookacle.tree.builder.ClusterTreeBuilder"><code>ClusterTreeBuilder</code></a>, which implements the methodology in the RAPTOR paper:</p>
<ul>
<li>Split the documents into chunks and create the leaf nodes from these chunks.</li>
<li>For each subsequent layer:<ul>
<li>Cluster the nodes in the previous layer.</li>
<li>For each cluster, concatenate the texts of the nodes, summarize the text, embed the summary and create a node.</li>
<li>Create the layer using the nodes of each cluster.</li>
</ul>
</li>
<li>Repeat the process till clustering is no longer possible.</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span class="n">config</span> <span class="o">=</span> <span class="n">ClusterTreeConfig</span><span class="p">(</span>
    <span class="n">embedding_model</span><span class="o">=</span><span class="n">embedding_model</span><span class="p">,</span>
    <span class="n">summarization_model</span><span class="o">=</span><span class="n">summarization_model</span><span class="p">,</span>
    <span class="n">document_splitter</span><span class="o">=</span><span class="n">document_splitter</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">tree_builder</span> <span class="o">=</span> <span class="n">ClusterTreeBuilder</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">tree_builder</span><span class="o">.</span><span class="n">build_from_documents</span><span class="p">(</span><span class="n">documents</span><span class="o">=</span><span class="n">documents</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tree: </span><span class="si">{</span><span class="n">tree</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="result">
<div class="language-python highlight"><pre><span></span><code><span class="n">Tree</span><span class="p">:</span> <span class="n">Tree</span><span class="p">(</span><span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
</div>
<details class="note" open="open">
<summary>More on Building the RAPTOR tree</summary>
<p>See <a href="building-raptor-tree/">Building the RAPTOR tree</a> for more details on building the raptor tree and how you can define your own methodology to build the tree.</p>
<p>You can also customize the clustering method used by <a class="autorefs autorefs-internal" href="../reference/tree/builder/#bookacle.tree.builder.ClusterTreeBuilder"><code>ClusterTreeBuilder</code></a> by changing the clustering function and the clustering backend. See <a href="clustering/">Clustering Support</a> for more details.</p>
</details>
<p>We then create the retriever using <a class="autorefs autorefs-internal" href="../reference/tree/retriever/#bookacle.tree.retriever.TreeRetriever"><code>TreeRetriever</code></a>, which implements both the collapsed-tree and tree-traversal methods from the RAPTOR paper:</p>
<div class="language-python highlight"><pre><span></span><code><span class="n">retriever_config</span> <span class="o">=</span> <span class="n">TreeRetrieverConfig</span><span class="p">(</span><span class="n">embedding_model</span><span class="o">=</span><span class="n">embedding_model</span><span class="p">)</span>
<span class="n">retriever</span> <span class="o">=</span> <span class="n">TreeRetriever</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">retriever_config</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retriever: </span><span class="si">{</span><span class="n">retriever</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="result">
<div class="language-python highlight"><pre><span></span><code><span class="n">Retriever</span><span class="p">:</span> <span class="n">TreeRetriever</span><span class="p">()</span>
</code></pre></div>
</div>
<details class="note" open="open">
<summary>More on Retrievers</summary>
<p>See <a href="retriever/">Retriever</a> for more details on retrievers and how you can implement your own retrievers.</p>
</details>
<p>Then, we send a query to the retriever and fetch relevant context:</p>
<div class="language-python highlight"><pre><span></span><code><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;Who are the cast members of The Godfather?&quot;</span>

<span class="n">_</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">retriever</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">tree</span><span class="o">=</span><span class="n">tree</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrieved context:</span><span class="se">\n</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="result">
<div class="language-text highlight"><pre><span></span><code>Retrieved context:
Mario Puzo wrote the screenplay for the movie &quot;The Godfather&quot;, which chronicles the life of Vito Corleone, one of the five families of the Mafia. The film stars an ensemble cast including Marlon Brando, Al Pacino, James Caan, Richard Castellano, Robert Duvall,  Sterling Hayden,  John Marley,  Richard Conte  and  Diane Keaton. The film focuses on the transformation of Michael Corleone from a reluctant outsider

The Godfather is an epic gangster film directed by Francis Ford Coppola. It stars Marlon Brando, Al Pacino, James Caan, Richard Castellano, Robert Duvall, Sterling Hayden, John Marley, Richard Conte, Diane Keaton, Cesar Romero, and others. It tells the story of the Corleone family from 1945 to 1955, focusing on the transformation of Vito Corleone, the youngest son.

the office and pay reverence to Michael as &quot;Don Corleone&quot;.
▪ Marlon Brando as Vito Corleone: crime boss and
patriarch of the Corleone family
▪ Al Pacino as Michael Corleone: Vito&#39;s youngest son
▪ James Caan as Sonny Corleone: Vito&#39;s eldest son
▪ Richard Castellano as Peter Clemenza: a caporegime in
the Corleone crime family, Sonny&#39;s godfather
▪ Robert Duvall as Tom Hagen: Corleone consigliere,
lawyer
, and unoﬃcial adopted member of the
Corleone family
▪ Sterling Hayden as Captain McCluskey: a corrupt
police captain on Sollozzo&#39;s payroll
▪ John Marley as Jack Woltz: Hollywood ﬁlm producer
who is intimidated by the Corleones
▪ Richard Conte as Emilio Barzini: a crime boss of a rival
family

▪ Gianni Russo as Carlo Rizzi: Connie&#39;s abusive husband
▪ John Cazale as Fredo Corleone: Vito&#39;s middle son
▪ Rudy Bond as Cuneo: a crime boss of a rival family
▪ Al Martino as Johnny Fontane: a singer and Vito&#39;s
godson
▪ Morgana King as Carmela Corleone: Vito&#39;s wife
▪ Lenny Montana as Luca Brasi: Vito&#39;s enforcer
▪ Johnny Martino as Paulie Gatto: a soldier in the
Corleone crime family
▪ Salvatore Corsitto as Amerigo Bonasera: the
undertaker who asks for a favor at Connie&#39;s wedding
▪ Richard Bright as Al Neri: the soldier in the Corleone
crime family who becomes Michael&#39;s enforcer
▪ Alex Rocco as Moe Greene: a Jewish mobster and Las
Vegas casino proprietor
▪ Tony Giorgio as Bruno Tattaglia

co-wrote the screenplay with Mario Puzo, based on Puzo&#39;s best-selling 1969 novel. The film stars
an ensemble cast including Marlon Brando, Al Pacino, James Caan, Richard Castellano, Robert
Duvall,  Sterling  Hayden,  John  Marley,  Richard  Conte  and  Diane  Keaton.  It  is  the  first
installment in The Godfather trilogy, chronicling the Corleone family under patriarch Vito
Corleone (Brando) from 1945 to 1955. It focuses on the transformation of his youngest son,
Michael Corleone (Pacino), from reluctant family outsider to ruthless mafia boss.
Paramount Pictures obtained the rights to the novel for $80,000, before it gained popularity.
Studio executives had trouble finding a director; the first few candidates turned down the
position before Coppola signed on to direct the film but disagreement followed over casting
several  characters,  in  particular,  Vito  (Brando)  and  Michael  (Pacino).  Filming  took  place
primarily in locations around New York City and Sicily, and it was completed ahead of schedule.
</code></pre></div>
</div>
<p>Finally, we set the system prompt (optional) for the question-answering model and get an answer from the it:</p>
<div class="language-python highlight"><pre><span></span><code><span class="n">system_prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;You are a helpful assistant, designed to help users understand documents and answer questions on the documents.</span>
<span class="s2">Use your knowledge and the context passed to you to answer user queries.</span>
<span class="s2">The context will be text extracted from the document. It will be denoted by CONTEXT: in the prompt.</span>
<span class="s2">The user&#39;s query will be denoted by QUERY: in the prompt.</span>
<span class="s2">Do NOT explicitly state that you are referring to the context.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">history</span> <span class="o">=</span> <span class="p">[</span><span class="n">Message</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">system_prompt</span><span class="p">)]</span>

<span class="n">answer</span> <span class="o">=</span> <span class="n">qa_model</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Answer:</span><span class="se">\n</span><span class="si">{</span><span class="n">answer</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="result">
<div class="language-text highlight"><pre><span></span><code>Answer:
The cast members of &quot;The Godfather&quot; are as follows:

1. Marlon Brando - Vito Corleone
2. Al Pacino - Michael Corleone
3. James Caan - Sonny Corleone
4. Richard Castellano - Peter Clemenza
5. Robert Duvall - Tom Hagen
6. Sterling Hayden - Captain McCluskey
7. John Marley - Jack Woltz
8. Richard Conte - Emilio Barzini
9. Diane Keaton - Gianni Russo
10. Cesar Romero - Carlo Rizzi
11. John Cazale - Fredo Corleone
12. Rudy Bond - Cuneo
13. Al Martino - Johnny Fontane
14. Morgana King - Carmela Corleone
15. Lenny Montana - Luca Brasi
16. Johnny Martino - Paulie Gatto
17. Salvatore Corsitto - Amerigo Bonasera
18. Richard Bright - Al Neri
19. Alex Rocco - Moe Greene
20. Tony Giorgio - Bruno Tattaglia
</code></pre></div>
</div>
<h2 id="chat-interface">Chat Interface<a class="headerlink" href="#chat-interface" title="Permanent link">¤</a></h2>
<p><code>bookacle</code> comes with a built-in terminal-based chat interface powered by <a href="https://github.com/Textualize/rich"><code>rich</code></a> and <a href="https://github.com/prompt-toolkit/python-prompt-toolkit"><code>prompt-toolkit</code></a>, which supports the following:</p>
<ul>
<li>Autocompletion in the chat.</li>
<li>Custom user avatars.</li>
<li>Markdown rendering.</li>
<li>Streaming output with a nice progress bar.</li>
<li>Pass a system prompt to the question-answering model.</li>
<li>Store chat history in a file as you chat, etc.</li>
</ul>
<h3 id="launch-from-a-script">Launch from a script<a class="headerlink" href="#launch-from-a-script" title="Permanent link">¤</a></h3>
<p>The chat interface can be launched in a script by using <a class="autorefs autorefs-internal" href="../reference/chat/#bookacle.chat.Chat"><code>Chat</code></a>.</p>
<div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">rich.console</span> <span class="kn">import</span> <span class="n">Console</span>
<span class="kn">from</span> <span class="nn">bookacle.chat</span> <span class="kn">import</span> <span class="n">Chat</span>

<span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>

<span class="n">chat</span> <span class="o">=</span> <span class="n">Chat</span><span class="p">(</span>
    <span class="n">retriever</span><span class="o">=</span><span class="n">retriever</span><span class="p">,</span>
    <span class="n">qa_model</span><span class="o">=</span><span class="n">qa_model</span><span class="p">,</span>
    <span class="n">console</span><span class="o">=</span><span class="n">console</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">system_prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;You are a helpful assistant, designed to help users understand documents and answer questions on the documents.</span>
<span class="s2">Use your knowledge and the context passed to you to answer user queries.</span>
<span class="s2">The context will be text extracted from the document. It will be denoted by CONTEXT: in the prompt.</span>
<span class="s2">The user&#39;s query will be denoted by QUERY: in the prompt.</span>
<span class="s2">Always respond in Markdown.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">chat</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">tree</span><span class="o">=</span><span class="n">tree</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">system_prompt</span><span class="o">=</span><span class="n">system_prompt</span><span class="p">)</span>
</code></pre></div>
<p>Here is an example interaction:</p>
<p><img alt="Chat Interaction" src="../assets/chat-interaction.png" /></p>
<h3 id="terminal-based-chat">Terminal-based Chat<a class="headerlink" href="#terminal-based-chat" title="Permanent link">¤</a></h3>
<p>You can also use the chat via the CLI to interact with your documents.</p>
<div class="language-bash highlight"><pre><span></span><code>bookacle<span class="w"> </span>--help
</code></pre></div>
<div class="result">
<div class="language-ansi highlight"><pre><span></span><code> Usage: bookacle [OPTIONS] FILE_PATH                                                                                                                                                                                                                                   

╭─ Arguments ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ *    file_path      FILE  Path to the PDF file. [required]                                                                                                                                                                                                          │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─ Options ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ --loader              -l      [pymupdf4llm|pymupdf]  Loader to use. [default: pymupdf4llm]                                                                                                                                                                          │
│ --start-page          -s      INTEGER                The page (0-based) in the PDF file to start reading from. If not provided, defaults to 0, reading from the beginning.                                                                                          │
│ --end-page            -e      INTEGER                The page (0-based) in the PDF file to stop reading at (not inclusive). If not provided, the document will be read till the end.                                                                                │
│ --user-avatar         -a      TEXT                   Avatar that should be used for the user during chat. [default: 👤]                                                                                                                                             │
│ --history_file        -h      TEXT                   File where chat history should be stored. [default: /home/malay_agr/.bookacle-chat-history.txt]                                                                                                                │
│ --config-file         -c      FILE                   Custom configuration file. If not provided, the default settings are used.                                                                                                                                     │
│ --prompt-file         -p      FILE                   Custom prompts file. If not provided, the default prompts are used.                                                                                                                                            │
│ --version             -v                             Print version and exit.                                                                                                                                                                                        │
│ --install-completion                                 Install completion for the current shell.                                                                                                                                                                      │
│ --show-completion                                    Show completion for the current shell, to copy it or customize the installation.                                                                                                                               │
│ --help                                               Show this message and exit.                                                                                                                                                                                    │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
</code></pre></div>
</div>
<p>See <a href="cli/">Command-Line Interface</a> for more information on the usage.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../license/" class="md-footer__link md-footer__link--prev" aria-label="Previous: License">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                License
              </div>
            </div>
          </a>
        
        
          
          <a href="models/" class="md-footer__link md-footer__link--next" aria-label="Next: Models">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Models
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Malay Agarwal
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/MalayAgr" target="_blank" rel="noopener" title="Malay Agarwal on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
        <script src="../assets/_markdown_exec_pyodide.js"></script>
      
    
  </body>
</html>